(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{42509:function(e,t,n){"use strict";n.d(t,{D:function(){return s.Z}});var s=n(71340)},43208:function(e,t,n){Promise.resolve().then(n.bind(n,67233))},67233:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return k},dynamic:function(){return w}});var s=n(57437),l=n(42509),a=n(31706),r=n(62572),i=n(51809),c=n(17933),o=n(55856),d=n(85290),u=n(10887),m=n(67896),h=n(33116),x=n(2265),g=n(98809),p=n(43241),v=n(78583),f=n(21037);function j(e){var t;let{data:n}=e;return(0,s.jsx)("div",{className:"   w-full chatbox prose dark:prose-invert text-primary rounded p-2 ",children:(0,s.jsx)(p.U,{remarkPlugins:[g.Z],components:{code(e){let{node:t,inline:n,className:l,children:a,...r}=e,i=/language-(\w+)/.exec(l||""),c=i?i[1]:"text";return!n&&i?(0,s.jsx)(f.Z,{...r,style:v.Z,language:c,className:"rounded",PreTag:"div",wrapLongLines:!0,children:String(a).replace(/\n$/,"")}):(0,s.jsx)("code",{...r,className:l,children:a})}},children:null==(t=(t=n).replace(/\n/g,"  \n"))?void 0:t.replace(/```markdown\s+([\s\S]*?)\s+```/g,(e,t)=>t)})})}function b(e){let{metadata:t}=e,n=((null==t?void 0:t.metadata)||[]).map((e,t)=>(0,s.jsx)("div",{children:(0,s.jsx)("div",{className:"text-xs border p-2 mb-2",children:(0,s.jsx)(j,{data:e.content})})},"messagerow"+t));return(0,s.jsxs)("div",{style:{width:"300px",height:"calc(100% - 25px)"},className:"p-2 rounded border overflow-x-hidden overflow-y-auto h-full scroll",children:[" ",(0,s.jsx)("div",{className:"mb-2",children:" Agent Messages"}),(0,s.jsxs)("div",{className:"mb-2 text-xs",children:["The agent workflow generated ",n.length," message",n.length>1?"s":""," "]}),(0,s.jsx)("div",{children:n})]})}function N(e){let{context:t,config:n,initMessages:l,metadata:g,viewHeight:p="100%"}=e,v=x.useRef(null),f=x.useRef(null),[N,w]=x.useState(!1),[k,y]=x.useState(null),[Z,C]=x.useState({status:!0,message:"All good"}),[E,S]=x.useState([]),O=e=>e.map(e=>{let t;try{t=JSON.parse(e.metadata)}catch(n){t=e.metadata}let n={text:e.content,sender:"user"===e.role?"user":"bot",metadata:t,msgId:e.msgId};return n});x.useEffect(()=>{let e=O(l);S(e)},[l]);let P=E.map((e,t)=>{let n="user"===e.sender,l=!1;if(e.metadata){var o,d,u;l=null!==e.metadata.code||(null===(o=e.metadata.images)||void 0===o?void 0:o.length)>0||(null===(d=e.metadata.files)||void 0===d?void 0:d.length)>0||(null===(u=e.metadata.scripts)||void 0===u?void 0:u.length)>0}let h=[];return n&&h.push({label:(0,s.jsx)("div",{onClick:()=>{console.log("retrying"),D(e.text)},children:(0,s.jsxs)("span",{className:"inline-block",children:[" ",(0,s.jsx)(a.Z,{role:"button",title:"Retry",className:"h-4 w-4 mr-1 inline-block"}),"Retry"]})}),key:"retrymessage"}),l&&h.push({label:(0,s.jsxs)("div",{onClick:()=>{},children:[(0,s.jsx)(r.Z,{title:"View Metadata",className:"h-4 w-4 mr-1 inline-block"}),"View Metadata"]}),key:"metadata"}),m.Z,(0,s.jsxs)("div",{className:"align-right ".concat(n?"text-right":"","  mb-2 "),children:[" ",(0,s.jsxs)("div",{className:"  ".concat(n?"":" w-full"," inline-flex gap-2"),children:[(0,s.jsxs)("div",{className:"",children:[" ",n&&(0,s.jsx)(i.Z,{className:"inline-block h-6 "}),!n&&(0,s.jsxs)("span",{className:"inline-block  text-accent  bg-primary pb-2 ml-1",children:[(0,s.jsx)(c.Z,{className:"inline-block h-6 "})," "]})]}),(0,s.jsxs)("div",{className:"inline-block ".concat(n?"":" w-full "," p-2 rounded  ").concat(n?"bg-accent text-white  ":"bg-light"),children:[" ",n&&(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"inline-block",children:[e.text,(0,s.jsx)("div",{role:"button",onClick:()=>{console.log("retrying"),D(e.text)},children:(0,s.jsxs)("span",{className:"inline-block",children:[" ",(0,s.jsx)(a.Z,{role:"button",title:"Retry",className:"h-4 w-4 mr-1 inline-block"}),"Retry"]})})]})}),!n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j,{data:e.text}),(0,s.jsxs)("div",{role:"button",onClick:()=>{console.log("retrying"),D(e.text)},className:"text-xs mt-1",children:["View agent messages (",e.metadata.length,")"]})]})]})]})]},"message"+t)});x.useEffect(()=>{_()},[E]),x.useEffect(()=>{!1===N&&v.current&&v.current&&(null===Z||Z&&!1===Z.status)&&(v.current.value="")},[N]),x.useEffect(()=>{},[]);let R=e=>{let t="";return e.forEach(e=>{t+="".concat(e.sender,": ").concat(e.text," \n")}),t},_=()=>{var e;null===(e=f.current)||void 0===e||e.scroll({top:f.current.scrollHeight,behavior:"smooth"})},A=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;for(let n=e.length-1;n>=0;n--){let s=e[n].content;if(s.length>t)return s}return null},D=e=>{C(null);let t=Object.assign([],E),n=R(E);console.log("****history****",n),t.push({text:e,sender:"user"}),S(t);let s={prompt:e,history:n};console.log("payload",s);let l={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(s)};w(!0),fetch("".concat("/api","/generate"),l).then(e=>{w(!1),200===e.status?e.json().then(e=>{if(e&&e.status){console.log("******* response received ",e);let n=A(e.data),s={text:n,sender:"bot",metadata:e.data};y(s),t.push(s),S(t=Object.assign([],t))}else console.log("error",e),h.ZP.error(e.message)}):h.ZP.error("Connection error. Ensure server is up and running.")}).catch(e=>{w(!1),h.ZP.error("Connection error. Ensure server is up and running.")})};return(0,s.jsxs)("div",{className:"flex   h-full",children:[(0,s.jsxs)("div",{style:{height:"calc(100% - 20px)"},className:"text-primary   overflow-auto relative   rounded flex-1 ",children:[(0,s.jsxs)("div",{style:{height:"calc(100% - 100px)"},ref:f,className:"flex overflow-auto  flex-col rounded  scroll pr-2   ",children:[(0,s.jsx)("div",{className:"flex-1  boder mt-4"}),(0,s.jsxs)("div",{className:"ml-2 ",children:[" ",P]}),(0,s.jsx)("div",{className:"ml-2 h-6   mb-4 mt-2   ",children:N&&(0,s.jsxs)("div",{className:"inline-flex gap-2",children:[(0,s.jsx)("span",{className:"  rounded-full bg-accent h-2 w-2  inline-block"}),(0,s.jsx)("span",{className:"animate-bounce rounded-full bg-accent h-3 w-3  inline-block"}),(0,s.jsx)("span",{className:" rounded-full bg-accent h-2 w-2  inline-block"})]})})]}),(0,s.jsxs)("div",{className:"mt-2 p-2   w-full",children:[(0,s.jsxs)("div",{className:"mt-2   rounded p-2 shadow-lg flex mb-1    ".concat(N?" opacity-50 pointer-events-none":""),children:[(0,s.jsx)("form",{autoComplete:"on",className:"flex-1 ",onSubmit:e=>{e.preventDefault()},children:(0,s.jsx)("input",{id:"queryInput",name:"queryInput",autoComplete:"on",onKeyDown:e=>{if("Enter"===e.key&&v.current&&!N){var t;D(null===(t=v.current)||void 0===t?void 0:t.value)}},ref:v,className:"w-full text-gray-600 rounded rounded-r-none border border-accent bg-white p-2   ropunded-sm"})}),(0,s.jsxs)("div",{role:"button",onClick:()=>{if(v.current&&!N){var e;D(null===(e=v.current)||void 0===e?void 0:e.value)}},className:"bg-accent   hover:brightness-75 transition duration-300 rounded pt-2 rounded-l-none px-5 ",children:[" ",!N&&(0,s.jsxs)("div",{className:"inline-block     ",children:[(0,s.jsx)(o.Z,{className:"h-6 text-white   inline-block"})," "]}),N&&(0,s.jsx)("div",{className:"inline-block   ",children:(0,s.jsx)(d.Z,{className:"relative -pb-2 text-white animate-spin  inline-flex rounded-full h-6 w-6"})})]})]})," ",Z&&!Z.status&&(0,s.jsxs)("div",{className:"p-2 border rounded mt-4 text-orange-500 text-sm",children:[" ",(0,s.jsx)(u.Z,{className:"h-5 text-orange-500 inline-block mr-2"})," ",Z.message]})]})]}),k&&(0,s.jsx)("div",{children:(0,s.jsx)(b,{metadata:k})})]})}let w="force-static";async function k(){let[e,t]=x.useState({messages:null});return(0,s.jsxs)("main",{className:" h-full",children:[(0,s.jsx)(l.D,{className:"mb-4",children:"AutoGen Agent Chat "}),(0,s.jsx)(N,{context:null,config:null,initMessages:[],metadata:{get:e,set:t}})]})}}},function(e){e.O(0,[91,142,971,864,744],function(){return e(e.s=43208)}),_N_E=e.O()}]);